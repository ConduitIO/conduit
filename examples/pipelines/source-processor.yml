version: 2.2
pipelines:
  - id: add-department
    status: running
    description: >
      An example pipeline which reads data (imaginary employees) from two generator
      sources, processes it and writes it to a file.
      
      It attaches the built-in `field.set` processor to one of the sources
      to add a `department` field to its records. The records from the other source
      are not processed.
    connectors:
      - id: employees-1
        type: source
        plugin: builtin:generator
        settings:
          # employees collection
          collections.employees.format.type: "structured"
          collections.employees.format.options.id: int
          collections.employees.format.options.name: string
          collections.employees.format.options.company: string
          collections.employees.format.options.trial: bool
          recordCount: "1"
        processors:
          - id: extract-name
            plugin: field.set
            settings:
              field: '.Payload.After.department'
              value: 'finance'
      - id: employees-2
        type: source
        plugin: builtin:generator
        settings:
          # employees collection
          collections.employees.format.type: "structured"
          collections.employees.format.options.id: int
          collections.employees.format.options.name: string
          collections.employees.format.options.company: string
          collections.employees.format.options.trial: bool
          recordCount: "2"
      - id: file-destination
        type: destination
        plugin: builtin:file
        settings:
          path: ./example.out